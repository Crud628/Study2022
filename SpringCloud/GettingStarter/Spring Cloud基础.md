# 微服务

## 一.  什么是微服务

### 1.  单体应用的痛点

- 项目庞大，可能几十张表
- 容易出现尾大不掉的情景
- 代码风格、组件不统一
- 技术难以升级

### 2.  什么是服务化

- 拆分：从大而全变成了小而美
- 独立：独立开发，独立部署，职责明确
- 不关心具体实现

### 3.  什么是微服务

- 以专注于单一职责与功能的小型功能区块为基础
- 利用模块化的方式组合出复杂的大型应用程序
- 各功能区块与语言无关的API集相互通信



## 二.  微服务的特点

- 技术栈自由
- 按需弹性扩容
- 能力复用率比较高
- 部署和回滚成本低
- 康威定律：组织结构会跟着变动



## 三.  微服务的优缺点

### 1.  优点

- 技术栈不受限，新技术有发展空间
- 可用性强，一个宕机不会整体宕机
- 代码和机器使用率都提高了

### 2.  缺点

- 运维成本过高

- 接口可能不匹配
- 代码可能重复
- 架构复杂度提高

## 四.  微服务的两大门派

- Spring Cloud：由众多子项目组成

- Dubbo官网的定义：高性能、轻量级的开源服务框架

### 1.  通信协议对比

REST（Spring Cloud） vs RPC（Dubbo）

效率RPC更高，REST更灵活

### 2.  生态和社区活跃度

迭代速度：sc

是否稳定维护：sc

生态是否强大：sc

### 3.  如何选型

团队技术熟悉程度

## 五.  微服务拆分

### 1.  需要拆分的信号

- 事故频发，且原因是由于耦合导致
- 服务的启动和部署越来越蛮，甚至不可忍受
- 流量增加，需要扩容

### 2.  不必要拆分

- 为了拆分而拆分
- 系统要求变动和维护成本低
- 团队规模小

### 3.  如何拆分

- 领域拆分  商品归商品，用户归用户
- 热点拆分   例：秒杀商品
- 业务有限，逐步迭代
- 统筹安排全盘考虑



## 六.  微服务的扩展

单体集群：水平复制

微服务：功能解耦

数据拆分：分库分表

按需扩展

- CPU、内存、网络负载程度
- 特定时间
- 具有最佳使用率，节约成本



## 七.  微服务的重要模块

服务的注册与发现

微服务之间的调用

负载均衡

网关

熔断与降级